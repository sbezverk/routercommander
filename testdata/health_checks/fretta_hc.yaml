repro:
  times: 1
  stop_when_triggered: false
tests:
  - command: "admin show controller sfe driver location all"
    command_tests:
    - id: 1
      pattern:
        pattern_string: '0/FC[0-9]/[0-9]'
      field_separator: "|"
      fields:
        - field_number: 2
          operation: "compare_with_value_neq"
          value: "UP"
        - field_number: 4
          operation: "compare_with_value_neq"
          value: "UP/UP"
        - field_number: 6
          operation: "compare_with_value_neq"
          value: "NRML"
  - command: "show watchdog memory-state location all"
    command_tests:
    - id: 1
      pattern:
        pattern_string: 'Memory\s+State\s+:'
      field_separator: ":"
      fields:
        - field_number: 2
          operation: "compare_with_value_neq"
          value: "Normal"
  - command: "admin show controller fabric plane all"
    command_tests:
    - id: 1
      pattern:
        pattern_string: '[0-5]\s{4}\w'
      field_separator: " "
      fields:
        - field_number: 2
          operation: "compare_with_value_neq"
          value: "UP"
        - field_number: 3
          operation: "compare_with_value_neq"
          value: "UP"
  - command: "admin show controller fabric health"
    command_tests:
    - id: 1
      pattern:
        pattern_string: 'SFE status'
      field_separator: " "
      fields:
        - field_number: 2
          operation: "compare_with_value_neq"
          value: "Ok"
        - field_number: 3
          operation: "compare_with_value_neq"
          value: "Ok"
        - field_number: 4
          operation: "compare_with_value_neq"
          value: "Ok"
        - field_number: 5
          operation: "compare_with_value_neq"
          value: "Ok"
        - field_number: 6
          operation: "compare_with_value_neq"
          value: "Ok"
        - field_number: 7
          operation: "compare_with_value_neq"
          value: "Ok"
collect:
  process_result: true
commands:
  - command: show bundle brief
    patterns:
      - pattern_string: '[D|d][O|o][W|w][N|n]'
  - command: show controllers npu resources all location all
    patterns:
      # To display NPU id in the output, not a problem indicating pattern
      - pattern_string: 'Location:'
      - pattern_string: 'NPU-[0-9]'
      - pattern_string: 'OOR\s+State\s+:\s+(Red|Yellow)'
  - command: show interface
    patterns:
      # To display interface name, not a problem indicating pattern
      - pattern_string: 'is\s+up,\s+line\s+protocol\s+is\s+up'
      - pattern_string: '.+?(\s+[1-9]+[0-9]*\s+total\s+input\s+drops)'
      - pattern_string: '.+?(\s+[1-9]+[0-9]*\s+total\s+output\s+drops)'
      - pattern_string: '.+?(\s+[1-9]+[0-9]*\s+CRC)'
  - command: show asic-errors all summary location all
    patterns:
      - pattern_string: '.+?([0-9]{1}_[0-9]{1}_CPU0)'
      - pattern_string: 'Unexpected\s+error\s+count\s*:\s*[1-9]+[0-9]*'
      - pattern_string: 'SBE\s+error\s+count\s*:\s*[1-9]+[0-9]*'
      - pattern_string: 'MBE\s+error\s+count\s*:\s*[1-9]+[0-9]*'
      - pattern_string: 'Parity\s+error\s+count\s*:\s*[1-9]+[0-9]*'
  - command: 'show logging'
    patterns:
      - pattern_string: 'DUMPER'
      - pattern_string: 'OOR_'
      - pattern_string: 'HW_PROG_ERROR'
      - pattern_string: 'ASIC'
      - pattern_string: 'FAB'
  - command: admin show controller fabric plane all
    patterns:
    - pattern_string: '.+?(DN)'
  - command: admin show controller sfe driver location all
    process_result: true
    command_test_id: 1
  - command: show cef drops
    patterns:
    - pattern_string: '((:?\w+\s)+)(drops\s+)(packets\s+:)\s+[1-9]\d*\n'
  - command: "show watchdog memory-state location all"
    patterns:
    - pattern_string: 'CPU0'
    command_test_id: 1
  - command: "show controllers fia link-info rx 0 111 topo instance all location all"
    patterns:
    - pattern_string: 'Node ID:'
    - pattern_string: 'EN/DN'
  - command: "admin show controller fabric health"
    command_test_id: 1
  - command: "show asic-errors fia all all location all"
    patterns:
    - pattern_string: 'Tcam_Protection_Err'
